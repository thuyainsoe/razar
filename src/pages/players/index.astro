---
import PlayerTable from "../../components/PlayerTable.astro";
import Layout from "../../layouts/Layout.astro";
import { playerData } from "../../data/player";
const query: string | null = Astro.url.searchParams.get("country");
const filteredResult = playerData.filter((player) => {
  if (!query) return player?.country?.name?.toLocaleLowerCase() === "myanmar";
  return (
    query?.toLocaleLowerCase() === player?.country?.name?.toLocaleLowerCase()
  );
});
---

<Layout>
  <div
    class="flex flex-col md:flex-row w-full main-container py-[20px] md:py-[50px]"
  >
    <!-- Left Sidebar for Country Filter -->
    <aside class="w-full md:w-1/4 pb-4 md:p-4 !pt-0">
      <h2 class="text-xl font-bold text-text mb-4">Filter by Country</h2>
      <ul
        class="flex flex-col items-start w-full border"
        x-data="{ country: new URLSearchParams(window.location.search).get('country') || 'myanmar' }"
      >
        <li class="w-full">
          <button
            onclick="window.location.href = '/players?country=myanmar'"
            :class="country === 'myanmar' ? 'bg-primary text-white' : 'bg-white'"
            class="w-full p-2 text-left text-text hover:bg-opacity-80 transition text-base"
          >
            ğŸ‡²ğŸ‡² Myanmar
          </button>
        </li>
        <li class="w-full">
          <button
            onclick="window.location.href = '/players?country=philippines'"
            :class="country === 'philippines' ? 'bg-primary text-white' : 'bg-white'"
            class="w-full p-2 text-left text-text hover:bg-opacity-80 transition text-base"
          >
            ğŸ‡µğŸ‡­ Philippines
          </button>
        </li>
        <li class="w-full">
          <button
            onclick="window.location.href = '/players?country=indonesia'"
            :class="country === 'indonesia' ? 'bg-primary text-white' : 'bg-white'"
            class="w-full p-2 text-left text-text hover:bg-opacity-80 transition text-base"
          >
            ğŸ‡®ğŸ‡© Indonesia
          </button>
        </li>
        <li class="w-full">
          <button
            onclick="window.location.href = '/players?country=malaysia'"
            :class="country === 'malaysia' ? 'bg-primary text-white' : 'bg-white'"
            class="w-full p-2 text-left text-text hover:bg-opacity-80 transition text-base"
          >
            ğŸ‡²ğŸ‡¾ Malaysia
          </button>
        </li>
        <li class="w-full">
          <button
            onclick="window.location.href = '/players?country=thailand'"
            :class="country === 'thailand' ? 'bg-primary text-white' : 'bg-white'"
            class="w-full p-2 text-left text-text hover:bg-opacity-80 transition text-base"
          >
            ğŸ‡¹ğŸ‡­ Thailand
          </button>
        </li>
      </ul>
    </aside>

    <!-- Right Side Table -->
    <div class="w-full md:w-3/4 overflow-x-auto">
      <PlayerTable playerData={filteredResult} />
    </div>
  </div>
</Layout>
